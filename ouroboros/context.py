... (truncated for clarity - actual content would show specific code change)